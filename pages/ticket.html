<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Home</title>
        <style>
            button {
                -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            }

            .bigButton {
                height: 90%;
                aspect-ratio: 0.6724;
                margin-top: 5%;
                border: 1dvh solid white;
                background: #c9cacc;
                border-radius: 2dvh;
            }

            .smallButton1 {
                height: 44%;
                aspect-ratio: 1.5;
                margin-top: 5%;
                margin-bottom: 0.5%;
                border: 1dvh solid white;
                background: #c9cacc;
                border-radius: 2dvh;
            }

            .smallButton2 {
                height: 44%;
                aspect-ratio: 1.5;
                margin-top: 0.5%;
                margin-bottom: 5%;
                border: 1dvh solid white;
                background: #c9cacc;
                border-radius: 2dvh;
            }

            .mainButton {
                box-sizing: border-box;
            }

            .mainButton:active {
                filter: brightness(0.5);
            }

            .lang {
                height: 100%;
                border: 0.5dvh solid white;
                background: #9af2ff;
                color: black;
                aspect-ratio: 1.31;
                margin-right: 0.5%;
                border-radius: 1dvh;
                font-size: 2.1dvh;
                font-family: 'Arial', sans-serif;
                box-sizing: border-box;
                padding: 0;
            }

            .lang:active {
                border: 0.5dvh solid yellow;
            }

            .btnBevel {
                font-size: 0;
                height: 40%;
                aspect-ratio: 1.6;
                border: 1dvh outset #bcd77e;
                background: #bcd77e;
                margin-top: 0.5dvh;
                margin-bottom: 0.5dvh;
                margin-left: 0.2dvh;
                margin-right: 0.2dvh;
            }

            .shrink {
                aspect-ratio: 1.2;
            }

            .sel {
                border: 1dvh outset #efd344;
                background: #efd344;
            }

            .btnCancel {
                height: 80%;
                aspect-ratio: 1;
                border-radius: 100%;
                border: none;
                float: right;
                background: url(images/return_btn.svg);
                background-size: 100%;
                font-size: 0;
            }

            .btnCancel:active {
                background: url(images/return_btn_prs.svg);
                background-size: 100%;
            }

            .btnCancelRed {
                height: 80%;
                aspect-ratio: 1;
                border-radius: 100%;
                border: none;
                float: right;
                background: url(images/cancel_btn.svg);
                background-size: 100%;
                font-size: 0;
            }

            .btnCancelRed:active {
                background: url(images/cancel_btn_prs.svg);
                background-size: 100%;
            }
        </style>
    </head>

    <body style="overflow: hidden;background: url(images/bg.svg);background-size: 100%;">
        <div style="width: 100%;aspect-ratio: 4/3;flex-direction: column;">
            <div style="height: 15%;text-align: left;">
                <img src="images/sel.svg" style="height: 80%;" />
            </div>
            <div style="height: 15%;text-align: center;display: flex;flex-direction: row;">
                <div style="height: 100%;width: 65%;text-align: left;">
                    <img src="images/notice.svg" style="height: 80%;" />
                </div>
                <div style="height: 100%;width: 13%;text-align: left;">
                    <img src="images/fare_notice.svg" style="height: 55%;" />
                </div>
                <div id="fare_dp" style="height: 100%;width: 20%;text-align: right;display: none;">
                </div>
            </div>
            <div style="height: 50%;display: flex;flex-direction: column;text-align: left;">
                <div style="width: 65%;background: #7bb2d9;">
                    <span style="font-size: 4dvh;
                    font-family: 文鼎粗黑, 文鼎粗黑體, Noto Sans TC, sans-serif;
                    font-weight: 600;float: left;
                    color: #282472;">1. 單程票價(元)</span>
                    <span style="font-size: 3.5dvh;
                    font-family: Helvetica, Arial, sans-serif;
                    font-weight: 600;float: right;
                    color: #282472;">Ticket price (NT)</span>
                </div>
                <div style="height: 45%;width: 65%;">
                    <button id="p20" class="btnBevel price" onclick="selPrice(20)"><img src="images/20.svg"
                            style="height: 90%;" /></button>
                    <button id="p25" class="btnBevel price" onclick="selPrice(25)"><img src="images/25.svg"
                            style="height: 90%;" /></button>
                    <button id="p30" class="btnBevel price" onclick="selPrice(30)"><img src="images/30.svg"
                            style="height: 90%;" /></button>
                    <button id="p35" class="btnBevel price" onclick="selPrice(35)"><img src="images/35.svg"
                            style="height: 90%;" /></button>
                    <button id="p40" class="btnBevel price" onclick="selPrice(40)"><img src="images/40.svg"
                            style="height: 90%;" /></button>
                    <br>
                    <button id="p45" class="btnBevel price" onclick="selPrice(45)"><img src="images/45.svg"
                            style="height: 90%;" /></button>
                    <button id="p50" class="btnBevel price" onclick="selPrice(50)"><img src="images/50.svg"
                            style="height: 90%;" /></button>
                    <button id="p55" class="btnBevel price" onclick="selPrice(55)"><img src="images/55.svg"
                            style="height: 90%;" /></button>
                    <button id="p60" class="btnBevel price" onclick="selPrice(60)"><img src="images/60.svg"
                            style="height: 90%;" /></button>
                    <button id="p65" class="btnBevel price" onclick="selPrice(65)"><img src="images/65.svg"
                            style="height: 90%;" /></button>
                </div>
                <div style="width: 80%;background: #7bb2d9;">
                    <span style="font-size: 4dvh;
                    font-family: 文鼎粗黑, 文鼎粗黑體, Noto Sans TC, sans-serif;
                    font-weight: 600;float: left;
                    color: #282472;">2. 張數(1張免選)</span>
                    <span style="font-size: 3.5dvh;
                    font-family: Helvetica, Arial, sans-serif;
                    font-weight: 600;float: right;
                    color: #282472;">Number of tickets (if 2 or more)</span>
                </div>
                <div style="height: 45%;width: 100%;">
                    <button id="q1" class="btnBevel shrink sel" onclick="selQty(1)"><img src="images/1.svg"
                            style="height: 90%;" /></button>
                    <button id="q2" class="btnBevel shrink" onclick="selQty(2)"><img src="images/2.svg"
                            style="height: 90%;" /></button>
                    <button id="q3" class="btnBevel shrink" onclick="selQty(3)"><img src="images/3.svg"
                            style="height: 90%;" /></button>
                    <button id="q4" class="btnBevel shrink" onclick="selQty(4)"><img src="images/4.svg"
                            style="height: 90%;" /></button>
                    <button id="q5" class="btnBevel shrink" onclick="selQty(5)"><img src="images/5.svg"
                            style="height: 90%;" /></button>
                    <button id="q6" class="btnBevel shrink" onclick="selQty(6)"><img src="images/6.svg"
                            style="height: 90%;" /></button>
                    <button id="q7" class="btnBevel shrink" onclick="selQty(7)"><img src="images/7.svg"
                            style="height: 90%;" /></button>
                    <button id="q8" class="btnBevel shrink" onclick="selQty(8)"><img src="images/8.svg"
                            style="height: 90%;" /></button>
                    <button id="q9" class="btnBevel shrink" onclick="selQty(9)"><img src="images/9.svg"
                            style="height: 90%;" /></button>
                    <button id="q10" class="btnBevel shrink" onclick="selQty(10)"><img src="images/10.svg"
                            style="height: 90%;" /></button>
                </div>
            </div>
            <div style="height: 15.3%;display: flex;width: 85%;">
                <div style="height: 100%;display: flex;width: 70%;">
                    <img src="images/bills_acc.svg" style="height: 80%;float: left;" />
                </div>
                <div style="height: 100%;display: flex;width: 30%;flex-direction: row-reverse;">
                    <button id="btnReturn" class="btnCancel" onclick="goBack()"></button>
                    <button id="btnCancel" style="display: none;" class="btnCancelRed" onclick="cancel()"></button>
                </div>
            </div>
            <div style="height: 5.5%;display: flex;flex-direction: row;">
                <div style="width: 50%;text-align: left;margin-top: 1.5dvh;">
                    <span
                        style="font-size: 3.5dvh;font-family: Helvetica, Arial, sans-serif;font-weight: bold;color: black;">v3.0.6/
                        v30</span>
                </div>
                <div style="width: 50%;text-align: right;margin-top: 1.5dvh;">
                    <span id="date"
                        style="font-size: 3.5dvh;font-family: Helvetica, Arial, sans-serif;font-weight: bold;color: #1b0b97;"></span>
                </div>
            </div>
        </div>
        <script>
            var setPrice = undefined
            var setQty = 1

            function setDt() {
                var d = new Date()
                document.getElementById("date").innerHTML = d.getFullYear() + "/" + twoNums(d.getMonth() + 1) + "/" + twoNums(d.getDate()) + " " + twoNums(d.getHours()) + ":" + twoNums(d.getMinutes()) + ":" + twoNums(d.getSeconds())
            }
            setDt()
            function osc() {
                window.parent.touchSound()
            }

            function twoNums(num) {
                if (num.toString().length == 1) {
                    return "0" + num.toString()
                } else {
                    return num.toString()
                }
            }
            function goBack() {
                osc()
                setTimeout(
                    function () {
                        window.location.href = "home.html"
                    }
                    , 500)
            }

            function selPrice(price) {
                document.getElementById("fare_dp").style.display = null
                osc()
                var coll = document.getElementsByClassName("btnBevel price")
                for (var i = 0; i < coll.length; i++) {
                    coll[i].classList.remove("sel")
                }
                document.getElementById("p" + price).classList.add("sel")
                setPrice = price
                removeReturn()
                confirm()
            }
            function selQty(quantity) {
                osc()
                var coll = document.getElementsByClassName("btnBevel shrink")
                for (var i = 0; i < coll.length; i++) {
                    coll[i].classList.remove("sel")
                }
                document.getElementById("q" + quantity).classList.add("sel")
                setQty = quantity
                removeReturn()
                confirm()
            }
            setInterval(setDt, 1000)

            var x
            var y
            //Stolen code
            function confirm() {
                clearInterval(x)
                clearInterval(y)
                var arr = []
                if (setPrice !== undefined) {
                    window.parent.narrate("price",setPrice)
                    x = setTimeout(function () { window.parent.narrate("quantity",setQty) },2500)
                    y = setTimeout(function () { window.parent.narrate("process","insert_coin") },5000)
                    displayFare(setPrice * setQty)
                } else {
                    window.parent.narrate("quantity",setQty)
                }
            }

            function cancel () {
                osc()
                var coll = document.getElementsByClassName("btnBevel shrink")
                for (var i = 0; i < coll.length; i++) {
                    coll[i].classList.remove("sel")
                }
                document.getElementById("q1").classList.add("sel")
                setQty = 1
                document.getElementById("fare_dp").style.display = "none"
                var coll = document.getElementsByClassName("btnBevel price")
                for (var i = 0; i < coll.length; i++) {
                    coll[i].classList.remove("sel")
                }
                setPrice = undefined
                document.getElementById("btnCancel").style.display = "none"
                document.getElementById("btnReturn").style.display = null
            }

            function removeReturn () {
                document.getElementById("btnCancel").style.display = null
                document.getElementById("btnReturn").style.display = "none"
            }

            function displayFare (fare) {
                document.getElementById("fare_dp").innerHTML = ""
                var fareStr = fare.toString()
                for (var i = 0;i < fareStr.length;i++){
                    document.getElementById("fare_dp").innerHTML += "<img src='images/"+ fareStr[i] +".svg' style='height: 50%;' />"
                }
                document.getElementById("fare_dp").innerHTML += 
                "<img src='images/dollars.svg' style='height: 50%;' />"
            }
        </script>
    </body>

</html>